/**
 *
 * 链接zk
 *
 * */

var ZK = require('@dp/keepalive-zookeeper')
var co = require('co')

var PATH = '/DP/CONFIG'
const region = require('./region')

exports.init = function() {
    if (exports._initPromise) {
        return exports._initPromise
    }
    var zk = new ZK()

    let promise = exports._initPromise = co(function* () {
        yield zk.init()
        yield region.initRegionConfig(zk)

        exports.isInit = true
        exports.client = zk
    })
    return promise
}

exports.PATH = PATH

exports._initPromise = null
exports.isInit = false
